<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FixPoint - Request Service</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Bootstrap Datepicker -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.9.0/dist/css/bootstrap-datepicker.min.css">
    <!-- Custom CSS -->
    <style>
        .request-form-container {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        .service-category-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        .category-card {
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .category-card.selected {
            border-color: #0066cc;
            background-color: rgba(0, 102, 204, 0.05);
        }
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
        }
        .bg-gradient-primary {
            background: linear-gradient(to right, #0066cc, #17a2b8);
        }
        .form-label {
            font-weight: 500;
        }
        .provider-preview {
            border-radius: 10px;
            background-color: white;
            transition: transform 0.3s;
        }
        .provider-preview:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .provider-preview img {
            height: 150px;
            object-fit: cover;
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-gradient-primary">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-tools me-2"></i>FixPoint
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="user_dashboard.html">
                            <i class="fas fa-tachometer-alt me-1"></i> Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="browse_services.html">
                            <i class="fas fa-search me-1"></i> Browse Services
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="request_service.html">
                            <i class="fas fa-plus-circle me-1"></i> Request Service
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="my_requests.html">
                            <i class="fas fa-clipboard-list me-1"></i> My Requests
                        </a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-bell me-1"></i>
                            <span class="badge bg-danger notification-badge">3</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="#">Your plumbing request was approved</a></li>
                            <li><a class="dropdown-item" href="#">Electrician will arrive tomorrow</a></li>
                            <li><a class="dropdown-item" href="#">Please rate your recent service</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#">See all notifications</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user-circle me-1"></i> John Doe
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="user_profile.html"><i class="fas fa-id-card me-2"></i>My Profile</a></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i>Settings</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container my-5">
        <!-- Page Header -->
        <h2 class="mb-4">Request a Service</h2>
        
        <div class="row">
            <div class="col-lg-8">
                <!-- Service Request Form -->
                <div class="request-form-container">
                    <form id="serviceRequestForm">
                        <!-- Form Progress -->
                        <div class="mb-4">
                            <div class="progress" style="height: 4px;">
                                <div class="progress-bar" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                            <div class="d-flex justify-content-between mt-2">
                                <span class="fw-bold text-primary">1. Service</span>
                                <span class="text-muted">2. Details</span>
                                <span class="text-muted">3. Schedule</span>
                                <span class="text-muted">4. Review</span>
                            </div>
                        </div>

                        <!-- Step 1: Select Service Type -->
                        <div id="step1" class="form-step">
                            <h4 class="mb-3">Select Service Category</h4>
                            <div class="row g-3">
                                <!-- Category 1 -->
                                <div class="col-md-4 col-6">
                                    <div class="card category-card h-100 text-center">
                                        <div class="card-body">
                                            <i class="fas fa-bolt service-category-icon text-primary"></i>
                                            <h6 class="card-title">Electrical</h6>
                                        </div>
                                    </div>
                                </div>
                                <!-- Category 2 -->
                                <div class="col-md-4 col-6">
                                    <div class="card category-card h-100 text-center selected">
                                        <div class="card-body">
                                            <i class="fas fa-wrench service-category-icon text-primary"></i>
                                            <h6 class="card-title">Plumbing</h6>
                                        </div>
                                    </div>
                                </div>
                                <!-- Category 3 -->
                                <div class="col-md-4 col-6">
                                    <div class="card category-card h-100 text-center">
                                        <div class="card-body">
                                            <i class="fas fa-broom service-category-icon text-primary"></i>
                                            <h6 class="card-title">Cleaning</h6>
                                        </div>
                                    </div>
                                </div>
                                <!-- Category 4 -->
                                <div class="col-md-4 col-6">
                                    <div class="card category-card h-100 text-center">
                                        <div class="card-body">
                                            <i class="fas fa-paint-roller service-category-icon text-primary"></i>
                                            <h6 class="card-title">Painting</h6>
                                        </div>
                                    </div>
                                </div>
                                <!-- Category 5 -->
                                <div class="col-md-4 col-6">
                                    <div class="card category-card h-100 text-center">
                                        <div class="card-body">
                                            <i class="fas fa-hammer service-category-icon text-primary"></i>
                                            <h6 class="card-title">Carpentry</h6>
                                        </div>
                                    </div>
                                </div>
                                <!-- Category 6 -->
                                <div class="col-md-4 col-6">
                                    <div class="card category-card h-100 text-center">
                                        <div class="card-body">
                                            <i class="fas fa-snowflake service-category-icon text-primary"></i>
                                            <h6 class="card-title">AC Repair</h6>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <h5>Select Service</h5>
                                <div class="mb-3">
                                    <select class="form-select" id="serviceSelect">
                                        <option value="">Choose a specific service...</option>
                                        <!-- Services will be populated dynamically based on category -->
                                    </select>
                                </div>
                            </div>
                            
                            <div class="text-end mt-4">
                                <button type="button" class="btn btn-primary btn-next">Continue <i class="fas fa-arrow-right ms-1"></i></button>
                            </div>
                        </div>

                        <!-- Step 2: Service Details -->
                        <div id="step2" class="form-step" style="display: none;">
                            <h4 class="mb-3">Service Details</h4>
                            
                            <div class="mb-3">
                                <label for="serviceTitle" class="form-label">Service Title</label>
                                <input type="text" class="form-control" id="serviceTitle" placeholder="e.g., Leaking Kitchen Sink">
                            </div>
                            
                            <div class="mb-3">
                                <label for="serviceDescription" class="form-label">Describe your issue</label>
                                <textarea class="form-control" id="serviceDescription" rows="4" placeholder="Please provide details about the issue..."></textarea>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">Add photos (optional)</label>
                                <div class="input-group mb-3">
                                    <input type="file" class="form-control" id="servicePhotos" multiple>
                                    <label class="input-group-text" for="servicePhotos">Upload</label>
                                </div>
                                <small class="text-muted">You can upload up to 5 photos to help describe the issue.</small>
                            </div>
                            
                            <div class="mb-3">
                                <label for="serviceLocation" class="form-label">Service Location</label>
                                <select class="form-select mb-2" id="serviceLocation">
                                    <option value="home" selected>Home Address (123 Main St, City)</option>
                                    <option value="office">Office Address (456 Work Ave, City)</option>
                                    <option value="other">Other Location</option>
                                </select>
                            </div>
                            
                            <div class="text-end mt-4">
                                <button type="button" class="btn btn-outline-secondary btn-prev me-2"><i class="fas fa-arrow-left me-1"></i> Back</button>
                                <button type="button" class="btn btn-primary btn-next">Continue <i class="fas fa-arrow-right ms-1"></i></button>
                            </div>
                        </div>

                        <!-- Step 3: Schedule -->
                        <div id="step3" class="form-step" style="display: none;">
                            <h4 class="mb-3">Schedule Service</h4>
                            
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="preferredDate" class="form-label">Preferred Date</label>
                                    <div class="input-group date">
                                        <input type="text" class="form-control" id="preferredDate" placeholder="Select Date">
                                        <span class="input-group-text"><i class="fas fa-calendar"></i></span>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label for="preferredTime" class="form-label">Preferred Time</label>
                                    <select class="form-select" id="preferredTime">
                                        <option value="">Select time</option>
                                        <option value="Morning (8:00 AM - 12:00 PM)">Morning (8:00 AM - 12:00 PM)</option>
                                        <option value="Afternoon (12:00 PM - 4:00 PM)">Afternoon (12:00 PM - 4:00 PM)</option>
                                        <option value="Evening (4:00 PM - 8:00 PM)">Evening (4:00 PM - 8:00 PM)</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="alternateDate" class="form-label">Alternate Date (optional)</label>
                                <div class="input-group date">
                                    <input type="text" class="form-control" id="alternateDate" placeholder="Select Date">
                                    <span class="input-group-text"><i class="fas fa-calendar"></i></span>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="urgencyLevel" class="form-label">Urgency Level</label>
                                <select class="form-select" id="urgencyLevel">
                                    <option value="">Select urgency level</option>
                                    <option value="Standard (3-5 days)">Standard (3-5 days)</option>
                                    <option value="Priority (1-2 days)">Priority (1-2 days)</option>
                                    <option value="Emergency (Same day)">Emergency (Same day)</option>
                                </select>
                            </div>
                            
                            <div class="text-end mt-4">
                                <button type="button" class="btn btn-outline-secondary btn-prev me-2"><i class="fas fa-arrow-left me-1"></i> Back</button>
                                <button type="button" class="btn btn-primary btn-next">Continue <i class="fas fa-arrow-right ms-1"></i></button>
                            </div>
                        </div>

                        <!-- Step 4: Review and Submit -->
                        <div id="step4" class="form-step" style="display: none;">
                            <h4 class="mb-3">Review Your Request</h4>
                            
                            <div class="card mb-3">
                                <div class="card-body">
                                    <h5 class="card-title mb-3">Service Summary</h5>
                                    
                                    <div class="row mb-2">
                                        <div class="col-md-4 fw-bold">Category:</div>
                                        <div class="col-md-8" id="reviewCategory">-</div>
                                    </div>
                                    
                                    <div class="row mb-2">
                                        <div class="col-md-4 fw-bold">Service:</div>
                                        <div class="col-md-8" id="reviewService">-</div>
                                    </div>
                                    
                                    <div class="row mb-2">
                                        <div class="col-md-4 fw-bold">Title:</div>
                                        <div class="col-md-8" id="reviewTitle">-</div>
                                    </div>
                                    
                                    <div class="row mb-2">
                                        <div class="col-md-4 fw-bold">Description:</div>
                                        <div class="col-md-8" id="reviewDescription">-</div>
                                    </div>
                                    
                                    <div class="row mb-2">
                                        <div class="col-md-4 fw-bold">Location:</div>
                                        <div class="col-md-8" id="reviewLocation">-</div>
                                    </div>
                                    
                                    <div class="row mb-2">
                                        <div class="col-md-4 fw-bold">Date &amp; Time:</div>
                                        <div class="col-md-8" id="reviewDateTime">-</div>
                                    </div>
                                    
                                    <div class="row mb-2">
                                        <div class="col-md-4 fw-bold">Alternate Date:</div>
                                        <div class="col-md-8" id="reviewAlternateDate">-</div>
                                    </div>
                                    
                                    <div class="row mb-2">
                                        <div class="col-md-4 fw-bold">Urgency:</div>
                                        <div class="col-md-8" id="reviewUrgency">-</div>
                                    </div>
                                    
                                    <div class="row mb-2">
                                        <div class="col-md-4 fw-bold">Photos:</div>
                                        <div class="col-md-8" id="reviewPhotos">-</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-3 form-check">
                                <input type="checkbox" class="form-check-input" id="termsCheck" checked>
                                <label class="form-check-label" for="termsCheck">I agree to the <a href="#">terms and conditions</a> and <a href="#">cancellation policy</a>.</label>
                            </div>
                            
                            <div class="text-end mt-4">
                                <button type="button" class="btn btn-outline-secondary btn-prev me-2"><i class="fas fa-arrow-left me-1"></i> Back</button>
                                <button type="submit" class="btn btn-success"><i class="fas fa-check me-1"></i> Submit Request</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            
            <div class="col-lg-4 mt-4 mt-lg-0">
                <!-- Provider Preview (if selected) -->
                <div class="provider-preview mb-4">
                    <img src="/images/signup.jpg" class="w-100" alt="Provider">
                    <div class="p-3">
                        <h5>Pro Plumbing Solutions</h5>
                        <div class="d-flex mb-2">
                            <i class="fas fa-star text-warning"></i>
                            <i class="fas fa-star text-warning"></i>
                            <i class="fas fa-star text-warning"></i>
                            <i class="fas fa-star text-warning"></i>
                            <i class="fas fa-star text-warning"></i>
                            <span class="ms-1">5.0 (89 reviews)</span>
                        </div>
                        <p class="mb-2"><i class="fas fa-map-marker-alt me-1"></i> 3.1 miles away</p>
                        <p class="mb-0 text-success"><i class="fas fa-clock me-1"></i> Available today</p>
                    </div>
                </div>
                
                <!-- What to Expect -->
                <div class="card mb-4">
                    <div class="card-body">
                        <h5 class="card-title">What to Expect</h5>
                        <ul class="list-unstyled">
                            <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i> Quick response within 24 hours</li>
                            <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i> Verified professionals</li>
                            <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i> Upfront pricing</li>
                            <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i> Satisfaction guarantee</li>
                            <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i> Secure payment options</li>
                        </ul>
                    </div>
                </div>
                
                <!-- FAQ Section -->
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Frequently Asked Questions</h5>
                        <div class="accordion" id="faqAccordion">
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                                        How soon can I get service?
                                    </button>
                                </h2>
                                <div id="faq1" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        Service timeframes depend on provider availability and your urgency level. Standard requests typically get served within 3-5 days, Priority within 1-2 days, and Emergency services on the same day.
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                                        Can I cancel my request?
                                    </button>
                                </h2>
                                <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        Yes, you can cancel your service request up to 24 hours before the scheduled time without any fee. Cancellations within 24 hours may incur a cancellation fee.
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                                        How are service providers verified?
                                    </button>
                                </h2>
                                <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        All service providers undergo a thorough verification process including background checks, license verification, and reviews of past work. Only qualified professionals are allowed on our platform.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-3">
                    <h5><i class="fas fa-tools me-2"></i>FixPoint</h5>
                    <p>Your trusted platform for local home services.</p>
                </div>
                <div class="col-md-3">
                    <h6>Quick Links</h6>
                    <ul class="list-unstyled">
                        <li><a href="#" class="text-decoration-none  ">About Us</a></li>
                        <li><a href="#" class="text-decoration-none  ">Our Services</a></li>
                        <li><a href="#" class="text-decoration-none  ">Become a Provider</a></li>
                        <li><a href="#" class="text-decoration-none  ">Contact Us</a></li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h6>Contact Info</h6>
                    <ul class="list-unstyled  ">
                        <li><i class="fas fa-map-marker-alt me-2"></i>123 Service St, City, Country</li>
                        <li><i class="fas fa-phone me-2"></i>(123) 456-7890</li>
                        <li><i class="fas fa-envelope me-2"></i>info@fixpoint.com</li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h6>Follow Us</h6>
                    <div class="d-flex">
                        <a href="#" class="text-decoration-none text-white me-2"><i class="fab fa-facebook-square fa-2x"></i></a>
                        <a href="#" class="text-decoration-none text-white me-2"><i class="fab fa-twitter-square fa-2x"></i></a>
                        <a href="#" class="text-decoration-none text-white me-2"><i class="fab fa-instagram fa-2x"></i></a>
                        <a href="#" class="text-decoration-none text-white"><i class="fab fa-linkedin fa-2x"></i></a>
                    </div>
                    <div class="mt-3">
                        <form>
                            <div class="input-group">
                                <input type="email" class="form-control" placeholder="Subscribe to newsletter">
                                <button class="btn btn-primary" type="submit">Go</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <hr class="my-4">
            <div class="text-center  ">
                <small>&copy; 2023 FixPoint. All Rights Reserved.</small>
            </div>
        </div>
    </footer>

    <!-- Bootstrap 5 JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery (for datepicker) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Bootstrap Datepicker -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.9.0/dist/js/bootstrap-datepicker.min.js"></script>
    <!-- Custom Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize datepickers
            $('.date').datepicker({
                format: 'mm/dd/yyyy',
                autoclose: true
            });

            // Define services for each category
            const categoryServices = {
                'Electrical': [
                    'Wiring Installation',
                    'Circuit Breaker Repair',
                    'Outlet Installation',
                    'Light Fixture Installation',
                    'Electrical Panel Upgrade'
                ],
                'Plumbing': [
                    'Leaking Pipe Repair',
                    'Faucet Installation',
                    'Drain Cleaning',
                    'Toilet Repair',
                    'Water Heater Service'
                ],
                'Cleaning': [
                    'House Cleaning',
                    'Carpet Cleaning',
                    'Window Cleaning',
                    'Deep Cleaning',
                    'Move-in/Move-out Cleaning'
                ],
                'Painting': [
                    'Interior Painting',
                    'Exterior Painting',
                    'Wall Repair',
                    'Deck Staining',
                    'Furniture Painting'
                ],
                'Carpentry': [
                    'Furniture Repair',
                    'Door Installation',
                    'Cabinet Installation',
                    'Deck Building',
                    'Trim Work'
                ],
                'AC Repair': [
                    'AC Installation',
                    'AC Maintenance',
                    'AC Repair',
                    'Duct Cleaning',
                    'Thermostat Installation'
                ]
            };

            // Select elements
            const nextBtns = document.querySelectorAll('.btn-next');
            const prevBtns = document.querySelectorAll('.btn-prev');
            const formSteps = document.querySelectorAll('.form-step');
            const progressBar = document.querySelector('.progress-bar');
            const categoryCards = document.querySelectorAll('.category-card');
            const serviceSelect = document.getElementById('serviceSelect');
            const form = document.getElementById('serviceRequestForm');

            // Function to update service options based on selected category
            function updateServiceOptions() {
                const selectedCategory = document.querySelector('.category-card.selected .card-title').textContent;
                
                // Clear existing options
                serviceSelect.innerHTML = '<option value="">Choose a specific service...</option>';
                
                // Add category-specific services
                if (categoryServices[selectedCategory]) {
                    categoryServices[selectedCategory].forEach(service => {
                        const option = document.createElement('option');
                        option.value = service;
                        option.textContent = service;
                        serviceSelect.appendChild(option);
                    });
                }
            }

            // Function to update review section
            function updateReviewSection() {
                // Get current form values
                const category = document.querySelector('.category-card.selected .card-title')?.textContent || '-';
                const service = document.getElementById('serviceSelect').value || '-';
                const title = document.getElementById('serviceTitle').value || '-';
                const description = document.getElementById('serviceDescription').value || '-';
                const location = document.getElementById('serviceLocation').value || '-';
                const preferredDate = document.getElementById('preferredDate').value || '-';
                const preferredTime = document.getElementById('preferredTime').value || '-';
                const alternateDate = document.getElementById('alternateDate').value || '-';
                const urgencyLevel = document.getElementById('urgencyLevel').value || '-';
                const photos = document.getElementById('servicePhotos').files.length;

                // Update review section with current values
                document.getElementById('reviewCategory').textContent = category;
                document.getElementById('reviewService').textContent = service;
                document.getElementById('reviewTitle').textContent = title;
                document.getElementById('reviewDescription').textContent = description;
                document.getElementById('reviewLocation').textContent = location;
                document.getElementById('reviewDateTime').textContent = preferredDate && preferredTime ? `${preferredDate} - ${preferredTime}` : '-';
                document.getElementById('reviewAlternateDate').textContent = alternateDate;
                document.getElementById('reviewUrgency').textContent = urgencyLevel;
                document.getElementById('reviewPhotos').textContent = photos > 0 ? `${photos} photo(s) uploaded` : '-';
            }

            // Update review section when moving to step 4
            nextBtns.forEach((btn, index) => {
                btn.addEventListener('click', () => {
                    formSteps[index].style.display = 'none';
                    formSteps[index + 1].style.display = 'block';
                    
                    // Update progress bar and step indicators
                    const progress = ((index + 2) / formSteps.length) * 100;
                    progressBar.style.width = `${progress}%`;
                    
                    const stepIndicators = document.querySelectorAll('.progress-bar + div span');
                    stepIndicators.forEach((indicator, i) => {
                        if (i <= index + 1) {
                            indicator.classList.remove('text-muted');
                            indicator.classList.add('fw-bold', 'text-primary');
                        } else {
                            indicator.classList.add('text-muted');
                            indicator.classList.remove('fw-bold', 'text-primary');
                        }
                    });

                    // Update review section when moving to step 4
                    if (index === 2) { // When moving to step 4
                        updateReviewSection();
                    }
                });
            });

            // Previous button click
            prevBtns.forEach((btn, index) => {
                btn.addEventListener('click', () => {
                    formSteps[index + 1].style.display = 'none';
                    formSteps[index].style.display = 'block';
                    
                    // Update progress bar and step indicators
                    const progress = ((index + 1) / formSteps.length) * 100;
                    progressBar.style.width = `${progress}%`;
                    
                    const stepIndicators = document.querySelectorAll('.progress-bar + div span');
                    stepIndicators.forEach((indicator, i) => {
                        if (i <= index) {
                            indicator.classList.remove('text-muted');
                            indicator.classList.add('fw-bold', 'text-primary');
                        } else {
                            indicator.classList.add('text-muted');
                            indicator.classList.remove('fw-bold', 'text-primary');
                        }
                    });

                    // Update review section when going back
                    updateReviewSection();
                });
            });

            // Add event listeners to all form inputs
            const formInputs = document.querySelectorAll('input, select, textarea');
            formInputs.forEach(input => {
                input.addEventListener('change', updateReviewSection);
                input.addEventListener('input', updateReviewSection);
            });

            // Add event listener for service selection
            document.getElementById('serviceSelect').addEventListener('change', updateReviewSection);

            // Add event listener for category selection
            categoryCards.forEach(card => {
                card.addEventListener('click', function() {
                    categoryCards.forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    updateServiceOptions();
                    updateReviewSection();
                });
            });

            // Initialize datepickers with change event
            $('.date').datepicker({
                format: 'mm/dd/yyyy',
                autoclose: true
            }).on('changeDate', function() {
                updateReviewSection();
            });

            // Form submission
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const formData = new FormData();
                
                // Get selected category and service
                const selectedCategory = document.querySelector('.category-card.selected .card-title').textContent;
                const selectedService = serviceSelect.value;
                
                // Validate service-category combination
                if (!selectedCategory || !selectedService) {
                    alert('Please select both a category and a service');
                    return;
                }
                
                // Add form fields
                formData.append('category', selectedCategory);
                formData.append('serviceType', selectedService);
                formData.append('serviceTitle', document.getElementById('serviceTitle').value);
                formData.append('description', document.getElementById('serviceDescription').value);
                formData.append('scheduledDate', document.getElementById('preferredDate').value);
                formData.append('preferredTime', document.getElementById('preferredTime').value);
                formData.append('alternateDate', document.getElementById('alternateDate').value);
                formData.append('urgencyLevel', document.getElementById('urgencyLevel').value);
                formData.append('location', document.getElementById('serviceLocation').value);
                
                // Add photos if any
                const photoInput = document.getElementById('servicePhotos');
                if (photoInput.files.length > 0) {
                    Array.from(photoInput.files).forEach(file => {
                        formData.append('photos', file);
                    });
                }
                
                try {
                    // Show loading state
                    const submitBtn = document.querySelector('button[type="submit"]');
                    const originalBtnText = submitBtn.innerHTML;
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Submitting...';
            
                    const response = await fetch('/user/service-request', {
                        method: 'POST',
                        body: formData,
                        credentials: 'include'
                    });
            
                    const data = await response.json();
            
                    if (data.success) {
                        // Show success message
                        const messageElement = document.createElement('div');
                        messageElement.className = 'alert alert-success alert-dismissible fade show';
                        messageElement.innerHTML = `
                            <strong>Success!</strong> ${data.message}
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        `;
                        document.querySelector('.request-form-container').prepend(messageElement);
            
                        // Redirect to my requests page after 2 seconds
                        setTimeout(() => {
                            window.location.href = '/user/my_requests.html';
                        }, 2000);
                    } else {
                        // Show error message
                        const messageElement = document.createElement('div');
                        messageElement.className = 'alert alert-danger alert-dismissible fade show';
                        messageElement.innerHTML = `
                            <strong>Error!</strong> ${data.message}
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        `;
                        document.querySelector('.request-form-container').prepend(messageElement);
                    }
                } catch (error) {
                    console.error('Error:', error);
                    // Show error message
                    const messageElement = document.createElement('div');
                    messageElement.className = 'alert alert-danger alert-dismissible fade show';
                    messageElement.innerHTML = `
                        <strong>Error!</strong> An error occurred while submitting the request. Please try again.
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    `;
                    document.querySelector('.request-form-container').prepend(messageElement);
                } finally {
                    // Reset button state
                    const submitBtn = document.querySelector('button[type="submit"]');
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalBtnText;
                }
            });

            // Initialize service options for the default selected category
            updateServiceOptions();
        });
    </script>
</body>
</html>